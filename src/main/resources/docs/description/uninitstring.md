Dangerous usage of 'varname' (strncpy doesn't always null-terminate it).