Race condition: non-interlocked access after InterlockedDecrement(). Use InterlockedDecrement() return value instead.